#!/usr/bin/env bash
# common.env.example
# @version 2.2.0
# @description Common configuration shared across all backup profiles
# @author Jo Zapf
# @changed 2026-01-15 - Updated version to 2.2.0 (POST_BACKUP phase, logging fixes)
# @note Copy to common.env and adjust values for your system

# ============================================================================
# SYSTEM VERSION
# ============================================================================
export BACKUP_SYSTEM_VERSION="2.3.0"

# ============================================================================
# HARDWARE CONTROL - Shelly Plug Plus
# ============================================================================
# REPLACE with your Shelly Plug IP address
export SHELLY_IP="192.168.X.X"
export SHELLY_TOGGLE_AFTER_SEC="43200"          # 12 hours auto-off timeout
export DEVICE_WAIT_SECONDS="180"                # Wait time for device availability

# ============================================================================
# MOUNT CONFIGURATION
# ============================================================================
export BACKUP_MNT="/mnt/extern_backup"          # Mount point for backup device

# ============================================================================
# BORG SETTINGS
# ============================================================================
export BORG_PASSPHRASE_FILE="/root/.config/borg/passphrase"
export BORG_COMPRESSION="zstd,6"                # Compression algorithm and level
export BORG_LOCK_WAIT="60"                      # Lock wait timeout in seconds

# ============================================================================
# LOGGING
# ============================================================================
export LOCAL_LOG_DIR="/var/log/extern_backup"
export BACKUP_LOG_SUBDIR="logs"                 # Subdir in backup target for logs

# ============================================================================
# RECOVERY KEY EXPORT
# ============================================================================
export RECOVERY_ENABLED="true"                  # Enable/disable recovery key export
export RECOVERY_DIR="/home/user/Projekte/linux-backup-system/recovery"  # Recovery archive storage
export RECOVERY_ZIP_PASSWORD="your-secure-recovery-password"  # ZIP encryption password (empty = no password)
export RECOVERY_OWNER="user:user"               # File ownership for recovery archives

# ============================================================================
# RUNTIME STATE (populated by segments)
# ============================================================================
export LOCAL_LOG=""                             # Set by init_logging segment
export BACKUP_LOG=""                            # Set when mount successful
export TIMESTAMP=""                             # Set by init_logging segment
